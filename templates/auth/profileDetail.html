{% extends 'base.html'%} 
{% block title %}Profile{% endblock %} 
{% block content %}
<div class="middle col-8 col-sm-8 d-flex flex-column">
  <div
    class="profile-self rounded d-flex flex-row justify-content-start mt-2 mb-4"
  >
    <img
      class="avatar avatar-lg rounded-circle"
      alt="avatar"
      src="{{userProfile.avatar}}"
    />
    <span class="fullname-profile">{{userProfile.fullname}}</span>
    {% if request.user.profile_set.first == userProfile%}
    <button class="btn btn-info btn-edit rounded-end" data-bs-toggle="modal" data-bs-target="#editProfile"> Edit Profile </button>
    {% endif %}
  </div>
  {% if request.user.profile_set.first == userProfile%}
  <form method="post" enctype="multipart/form-data">
    <div
      class="post-area rounded d-flex flex-column justify-content-center mt-2 mb-4"
    >
      <div class="post-main d-flex flex-row rounded">
        <img
          class="avatar rounded-circle mx-2"
          alt="avatar"
          src="{{userProfile.avatar}}"
        />
        {{form.content}}
        <button type="submit" class="btn btn-success btn-post mx-2">Post</button>
      </div>
      <div class="post-bottom rounded-bottom d-flex flex-row">
        <div class="image-file-group ms-2 rounded-circle mt-1">
          <label for="image-post" class="image-post-image">
            <img for="image-post" class="rounded-circle img-fluid p-2" alt="camera-icon" src="https://cdn-icons-png.flaticon.com/512/4551/4551689.png"/>
          </label>
          <input id="image-post" name="image-post" type="file" multiple> 
        </div> 
      </div>
    </div>
    {% csrf_token %}
  </form>
  {% endif %}
  {% for post in object_list %}
  <div class="post-list d-flex flex-column mb-4">
    <div class="post-content rounded d-flex flex-column mb-2">
      <div class="post-content-header d-flex flex-row py-2">
        <img
          class="avatar rounded-circle mx-2"
          alt="avatar"
          src="{{userProfile.avatar}}"
        />
        <span class="post-username pt-3">{{userProfile.fullname}}</span>
      </div>
      <div class="post-content-body px-3 pb-3">
        <p>
          {{post.content}}
        </p>
        {% if post.attachment_set.all|length == 1 %}
        <img
          class="img-fluid rounded"
          alt="image-1"
          src="{{post.attachment_set.first.url}}"
        />
        {% elif post.attachment_set.all|length > 1 and post.attachment_set.all|length <= 4%}
        <div class="container text-center">
          <div class="row row-cols-2 g-3">
            {% for image in post.attachment_set.all%}
              <div class="col">
                <img class="img-fluid rounded" alt="image-post" src="{{image.url}}" />
              </div>
            {% endfor%}
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% include 'posts/listFriend.html' %} 


<!-- Modal -->
<form method="post" action="/updateProfile/" enctype="multipart/form-data">
<div class="modal fade" id="editProfile" tabindex="-1" aria-labelledby="editProfileModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="editProfileModalLabel">Edit Profile</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3 row">
          <label for="staticEmail" class="col-sm-2 col-form-label">Fullname</label>
          <div class="col-sm-10">
            <input type="text" class="form-control" id="inputFullname" name="fullname" value="{{request.user.profile_set.first.fullname}}">
          </div>
        </div>
        <div class="mb-3 row">
          <label for="inputPassword" class="col-sm-2 col-form-label">Avatar</label>
          <div class="col-sm-10">
            <input type="file" class="form-control" id="inputAvatar" name="avatar">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
{% csrf_token %}
<form>
{% endblock %}
